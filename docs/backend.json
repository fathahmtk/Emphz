{
  "entities": {
    "Product": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Product",
      "type": "object",
      "description": "Represents a GRP product in the dynamic product catalog.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Product entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the product."
        },
        "description": {
          "type": "string",
          "description": "Detailed specification of the product."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the product image.",
          "format": "uri"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "imageUrl"
      ]
    },
    "ProjectCaseStudy": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectCaseStudy",
      "type": "object",
      "description": "Represents a project case study with before-after images and details.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ProjectCaseStudy entity."
        },
        "title": {
          "type": "string",
          "description": "Title of the project case study."
        },
        "beforeImageUrl": {
          "type": "string",
          "description": "URL of the 'before' image.",
          "format": "uri"
        },
        "afterImageUrl": {
          "type": "string",
          "description": "URL of the 'after' image.",
          "format": "uri"
        },
        "details": {
          "type": "string",
          "description": "Detailed description of the project."
        },
        "location": {
          "type": "string",
          "description": "Location of the project."
        },
        "clientType": {
          "type": "string",
          "description": "Type of client for the project."
        }
      },
      "required": [
        "id",
        "title",
        "beforeImageUrl",
        "afterImageUrl",
        "details",
        "location",
        "clientType"
      ]
    },
    "TechnicalDownload": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TechnicalDownload",
      "type": "object",
      "description": "Represents a downloadable technical document (brochure, datasheet).",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the TechnicalDownload entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the downloadable document."
        },
        "fileUrl": {
          "type": "string",
          "description": "URL of the downloadable PDF file.",
          "format": "uri"
        },
        "description": {
          "type": "string",
          "description": "Description of the downloadable document."
        }
      },
      "required": [
        "id",
        "name",
        "fileUrl",
        "description"
      ]
    },
    "Lead": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Lead",
      "type": "object",
      "description": "Represents a lead captured from the contact form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Lead entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the lead."
        },
        "email": {
          "type": "string",
          "description": "Email address of the lead.",
          "format": "email"
        },
        "message": {
          "type": "string",
          "description": "Message submitted by the lead."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp when the lead was submitted.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "email",
        "message",
        "timestamp"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": {
            "$ref": "#/backend/entities/Product"
          },
          "description": "Stores product information for the dynamic product catalog. Publicly readable.",
          "params": [
            {
              "name": "productId",
              "description": "Unique identifier for the product."
            }
          ]
        }
      },
      {
        "path": "/project_case_studies/{projectCaseStudyId}",
        "definition": {
          "entityName": "ProjectCaseStudy",
          "schema": {
            "$ref": "#/backend/entities/ProjectCaseStudy"
          },
          "description": "Stores project case study information with before-after images and details. Publicly readable.",
          "params": [
            {
              "name": "projectCaseStudyId",
              "description": "Unique identifier for the project case study."
            }
          ]
        }
      },
      {
        "path": "/technical_downloads/{technicalDownloadId}",
        "definition": {
          "entityName": "TechnicalDownload",
          "schema": {
            "$ref": "#/backend/entities/TechnicalDownload"
          },
          "description": "Stores technical brochures and product data sheets (PDF links). Publicly readable.",
          "params": [
            {
              "name": "technicalDownloadId",
              "description": "Unique identifier for the technical download."
            }
          ]
        }
      },
      {
        "path": "/leads/{leadId}",
        "definition": {
          "entityName": "Lead",
          "schema": {
            "$ref": "#/backend/entities/Lead"
          },
          "description": "Stores lead data captured from the contact form.  Write-protected; can only be created by backend, read-protected.",
          "params": [
            {
              "name": "leadId",
              "description": "Unique identifier for the lead."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to support the Emphz application's core features, including a dynamic product catalog, project case studies, technical downloads, and lead tracking. The design prioritizes security, scalability, and debuggability by adhering to the principles of Authorization Independence, Structural Segregation, Access Modeling, and Data Clarity. Authorization Independence is achieved by avoiding hierarchical authorization dependencies, ensuring atomic operations and simplified debugging. Structural Segregation separates data with different access needs into distinct collections, simplifying security rules. Access Modeling employs consistent patterns for authorization, such as path-based ownership and membership maps. Data Clarity promotes explicit state modeling and predictable schema, enhancing maintainability.\n\nThe `products` and `project_case_studies` collections store product and case study data, respectively, and are publicly accessible for read operations, enabling the dynamic product catalog and project case studies features. The `technical_downloads` collection houses technical documents, also publicly accessible for downloads. The `leads` collection stores contact form submissions, accessible only to authorized admin users. This segregation ensures that sensitive lead data is protected while allowing public access to product information, case studies, and technical downloads.\n\nSpecifically, Authorization Independence is achieved as follows:\n*   `products`, `project_case_studies`, and `technical_downloads`: public read access eliminates the need for any authorization checks. No `get()` calls are needed in security rules.\n*   `leads`: restricted write access through server-side code or Firebase Authentication and associated security rules.\n\nQAPs are supported as follows:\n*   The segregation of publicly readable data into collections like `products`, `project_case_studies`, and `technical_downloads` allows for unrestricted `list` operations (QAP: Rules are not Filters) without compromising security.\n*   Sensitive data such as `leads` is stored in a separate collection with restricted access, ensuring that only authorized users can access the data."
  }
}